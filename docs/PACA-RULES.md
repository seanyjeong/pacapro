3# P-ACA 시스템 규정집

> 최종 업데이트: 2025년 12월 12일

---

## P-ACA란?

**P-ACA**는 **Physical Academy**의 약자로, 체육대학 입시를 준비하는 학생들을 위한 학원관리시스템입니다.

- **Physical**: 체육·신체
- **Academy**: 학원

### 로고의 의미

P-ACA 로고는 파란색 그라데이션 배경에 'P' 글자와 **역동적으로 달리는 사람**의 형상이 담겨 있습니다. 목표를 향해 전력 질주하는 체대입시 학생의 모습을 상징합니다.

---

## 목차

1. [수업 규정](#1-수업-규정)
2. [학원비 규정](#2-학원비-규정)
3. [출석 규정](#3-출석-규정)
4. [휴원/복귀 규정](#4-휴원복귀-규정)
5. [퇴원/졸업 규정](#5-퇴원졸업-규정)
6. [시즌(입시반) 규정](#6-시즌입시반-규정)
7. [체험 규정](#7-체험-규정)
8. [강사 급여 규정](#8-강사-급여-규정)
9. [학년 진급 규정](#9-학년-진급-규정)
10. [시스템 자동화](#10-시스템-자동화)
11. [개인정보보호 규정](#11-개인정보보호-규정)

---

## 1. 수업 규정

### 1.1 기본 수업 횟수

| 주간 수업 | 월간 수업 (4주 기준) |
|----------|---------------------|
| 주 2회 | **월 8회** |
| 주 3회 | **월 12회** |
| 주 4회 | **월 16회** |
| 주 5회 | **월 20회** |

### 1.2 4주 초과 수업

- 한 달 = **4주 기준**으로 계산
- 4주를 초과하는 수업(5주차)은 **무료 수업**으로 제공
- 예: 주 2회 수강생이 5주차에 수업 → 추가 요금 없음

### 1.3 수업 시간대

수업 시간대는 **해당 학원에서 설정한 시간**을 따릅니다.

| 시간대 | 코드 | 설명 |
|--------|------|------|
| 오전 | `morning` | 학원에서 설정한 오전 시간 |
| 오후 | `afternoon` | 학원에서 설정한 오후 시간 |
| 저녁 | `evening` | 학원에서 설정한 저녁 시간 |

---

## 2. 학원비 규정

### 2.1 기본 계산

```
최종금액 = 기본요금 - 할인금액 + 추가금액
```

- **금액 단위**: 천원 단위 절삭 (백원 이하 버림)
- **예시**: 152,500원 → 152,000원

### 2.2 할인 적용

- **할인율**: 0~100% (students.discount_rate)
- **할인 금액 계산**: `기본요금 × 할인율 / 100`

### 2.3 납부 기한

- **기본 납부일**: 학원 설정 (academy_settings.tuition_due_day)
- **월중 등록 시**: 등록일 + 7일

### 2.4 일할 계산 (4주 고정 기준)

#### 기본 원칙
- **월 총 수업일 = 주간 횟수 × 4** (고정)
- 주2회 → 8회, 주3회 → 12회, 주4회 → 16회

#### 월중 등록 시
```
일할요금 = 월요금 × (남은수업일 / 월총수업일)
         월총수업일 = 주간횟수 × 4 (고정)
```
- 남은수업일: 등록일~말일 중 실제 수업요일 카운트
- 천원 단위 절삭
- **예시**: 주2회 학생이 15일 등록, 남은 수업일 3회
  - `월수강료 × (3/8) = 37.5%`

#### 휴원 복귀 시
```
복귀월요금 = 월요금 × (남은수업일 / 월총수업일)
           월총수업일 = 주간횟수 × 4 (고정)
```
- 남은수업일: 복귀일~말일 중 실제 수업요일 카운트
- 납부기한: 복귀일 + 7일
- **예시**: 주3회 학생이 20일 복귀, 남은 수업일 5회
  - `월수강료 × (5/12) = 41.6%`

### 2.5 미납 처리

- 납부기한 초과 시 **연체** 상태 표시
- 자동 알림톡 발송 가능 (설정 시)

---

## 3. 출석 규정

### 3.1 학생 출석 상태

| 상태 | 코드 | 설명 | 수업 인정 |
|------|------|------|----------|
| 출석 | `present` | 정상 출석 | O |
| 지각 | `late` | 지각 출석 | O |
| 결석 | `absent` | 무단 결석 | X |
| 공결 | `excused` | 공식 사유 결석 | X (별도 처리) |
| 보충 | `makeup` | 보충수업 예정 | - |

### 3.2 공결 규정

**인정 사유:**
- 질병
- 학교 시험

**처리 방식:**
> 학원은 학교가 아니므로, 공결은 **출석으로 인정되지 않습니다.**

1. **5주차가 있는 달**: 5주차 무료수업으로 공결분을 대체 (별도 정산 없음)
2. **5주차가 없는 달**: 공결로 인해 월 수업 횟수가 기준(주 2회 = 8회)에 미달할 경우, 다음 달 학원비에서 해당 수업료만큼 차감

**예시:**
- 주 2회 학생이 공결 1회 발생 → 해당 월 7회 수업 → 다음 달 학원비에서 1회분 차감

### 3.3 보충 수업

- 결석 또는 공결 시, **같은 달 다른 날짜에 보충수업** 권장
- 보충수업 받으면 별도 정산 불필요
- 원래 결석일: `makeup` 상태로 기록
- 보충 진행일: `present` 상태로 기록

### 3.4 강사 출근 상태

| 상태 | 코드 | 급여 반영 |
|------|------|----------|
| 출근 | `present` | 100% |
| 지각 | `late` | 100% |
| 반차 | `half_day` | 50% |
| 결근 | `absent` | 0% |

---

## 4. 휴원/복귀 규정

### 4.1 휴원 신청

**필요 정보:**
- 휴식 시작일 (필수)
- 휴식 종료일 (선택, 없으면 무기한)
- 휴식 사유 (선택)
- 이월/환불 선택 (선택)

**처리 내용:**
1. 상태 변경: `active` → `paused`
2. 스케줄에서 제외
3. 학원비 생성 중단
4. 이월 크레딧 생성 (선택 시)

### 4.2 이월 크레딧 계산

```
일일요금 = 월요금 / 해당월날수
크레딧금액 = 일일요금 × 휴식일수 (천원 단위 절삭)
```

### 4.3 복귀 처리

**자동 처리:**
1. 상태 변경: `paused` → `active`
2. 스케줄 재배정
3. 복귀월 학원비 생성 (일할계산)
4. 이월 크레딧 자동 차감

---

## 5. 퇴원/졸업 규정

### 5.1 학생 상태

| 상태 | 코드 | 스케줄 | 학원비 | 진급 |
|------|------|--------|--------|------|
| 재원 | `active` | O | O | O |
| 휴원 | `paused` | X | X | O |
| 퇴원 | `withdrawn` | X | X | X |
| 졸업 | `graduated` | X | X | X |
| 체험 | `trial` | O | X | X |

### 5.2 퇴원 처리

**자동 삭제:**
- 미납 학원비 전체 삭제
- 시즌 등록 취소 (환불 처리)
- 미래 스케줄 삭제

**보관:**
- 과거 출석 기록
- 납부 완료된 학원비 기록

### 5.3 졸업 처리

- **대상**: 고3, N수 학생
- **처리**: `status = 'graduated'`
- **이후**: 스케줄/학원비 생성 제외

---

## 6. 시즌(입시반) 규정

### 6.1 시즌 정의

- 입시 집중반, 특강 등 별도 운영 기간
- 정규 수업과 별도로 등록/관리
- 예: "2025 정시 집중반", "여름 특강"

### 6.2 시즌 등록

**필요 정보:**
- 시즌 선택
- 시간대 선택 (학년별 기본값 또는 직접 선택)
- 할인 금액 (선택)

**납부기한 계산:**
- 시즌 시작 전 등록: `MIN(등록일+7, 시즌시작일)`
- 시즌 시작 후 등록: `등록일 + 7일`

### 6.3 시즌 중도 합류

```
시즌비 = 전체시즌비 × (남은수업일 / 전체수업일)
```
- 천원 단위 절삭

### 6.4 시즌 환불 규정

**학원법 기준:**

| 진행률 | 환불율 |
|--------|--------|
| 1/3 미만 경과 | 2/3 환불 |
| 1/2 미만 경과 | 1/2 환불 |
| 1/2 이상 경과 | 환불 불가 |

**실제 환불금 계산:**
```
이용료 = 실제납부금 × (이용일수 / 전체일수)
환불금 = 실제납부금 - 이용료
```

**부가세 옵션:**
- VAT 10% 제외 가능 (선택)

---

## 7. 체험 규정

### 7.1 체험 기본 정보

- **횟수**: 최대 **2회** 무료 체험
- **월회비**: 0원
- **대상**: 신규 상담 학생

### 7.2 체험 등록

**필요 정보:**
- 체험 날짜 (최소 1개, 최대 2개)
- 각 날짜별 시간대 선택

### 7.3 체험 진행

- 출석/지각 기록 시 체험 횟수 차감
- 2회 완료 후 정식 등록 안내

### 7.4 정식 등록 전환

**변경 내용:**
- `status`: `trial` → `active`
- `is_trial`: `true` → `false`
- `monthly_tuition`: 0 → 실제 금액
- `class_days`: 정규 수업 요일 설정
- 스케줄 자동 배정

---

## 8. 강사 급여 규정

### 8.1 급여 형태

| 형태 | 코드 | 계산 방식 |
|------|------|----------|
| 시급제 | `hourly` | 시급 × 근무시간 |
| 타임제 | `per_class` | 수업당요금 × 수업횟수 |
| 월급제 | `monthly` | 기본월급 (고정) |

### 8.2 4대보험 요율 (2025년 기준)

| 항목 | 본인 부담 | 사업주 부담 |
|------|----------|------------|
| 국민연금 | 4.5% | 4.5% |
| 건강보험 | 3.545% | 3.545% |
| 장기요양 | 건보료×12.97% | 건보료×12.97% |
| 고용보험 | 0.9% | 0.9%+ |

### 8.3 프리랜서 세금 (3.3%)

```
세금 = 총지급액 × 3.3%
실수령액 = 총지급액 - 세금
```

### 8.4 급여 계산 시점

- 출근 체크 시 자동 계산/업데이트
- 월말 급여 확정
- 재계산 가능 (미지급 상태만)

---

## 9. 학년 진급 규정

### 9.1 자동 진급

**실행 시점:** 매년 3월 1일 오전 1시 (한국시간)

**진급 순서:**
```
중1 → 중2 → 중3 → 고1 → 고2 → 고3 → N수 → N수(유지)
```

### 9.2 진급 대상

| 상태 | 진급 여부 |
|------|----------|
| 재원 (active) | O |
| 휴원 (paused) | O |
| 퇴원 (withdrawn) | X |
| 졸업 (graduated) | X |

---

## 10. 시스템 자동화

### 10.1 월별 학원비 생성

- **실행 시점**: 매월 1일
- **대상**: 재원생 (`status = 'active'`)
- **처리**: 기본요금 - 할인 + 추가 - 이월크레딧

### 10.2 알림톡 자동 발송

- **조건**: 오늘 수업 있는 미납자
- **시간**: 학원 설정에 따름
- **방식**: 솔라피 또는 네이버 SENS

### 10.3 학년 자동 진급

- **시점**: 매년 3월 1일 01:00 (KST)
- **대상**: 재원생 + 휴원생

### 10.4 Google Sheets 동기화

- **시점**: 매일 오전 9시
- **내용**: 학생명단, 월별수납

---

## 부록: 주요 코드 위치

| 기능 | 파일 경로 |
|------|----------|
| 학원비 계산 | `/supermax/paca/backend/routes/payments.js` |
| 급여 계산 | `/supermax/paca/backend/utils/salaryCalculator.js` |
| 시즌 계산 | `/supermax/paca/backend/utils/seasonCalculator.js` |
| 학생 관리 | `/supermax/paca/backend/routes/students.js` |
| 출석 관리 | `/supermax/paca/backend/routes/schedules.js` |
| 학년 진급 | `/supermax/paca/backend/scheduler/gradePromotionScheduler.js` |
| 월별 청구 | `/supermax/paca/backend/scheduler/paymentScheduler.js` |

---

## 11. 개인정보보호 규정

### 11.1 개인정보보호법 준수

P-ACA는 개인정보보호법에 따라 민감 개인정보를 **AES-256-GCM** 알고리즘으로 암호화 저장합니다.

### 11.2 암호화 대상 정보

| 테이블 | 암호화 필드 | 민감도 |
|--------|-------------|--------|
| students | 이름, 전화번호, 학부모 전화번호, 주소 | 높음 |
| instructors | 이름, 전화번호, 주소, 주민번호, 계좌번호, 예금주 | 높음 |
| users | 이름, 전화번호 | 높음 |

### 11.3 암호화 제외 항목

- **금액 데이터** (수강료, 급여, 수입, 지출): DB 집계(SUM, AVG) 필요
- 대신 **API 권한**으로 owner/admin만 조회 가능하도록 제한

### 11.4 보안 조치 현황

| 항목 | 상태 | 설명 |
|------|------|------|
| 민감정보 암호화 | ✅ 적용 | AES-256-GCM (2025.12 적용) |
| 비밀번호 해싱 | ✅ 적용 | bcrypt (salt 10) |
| JWT 인증 | ✅ 적용 | 로그인 토큰 기반 |
| 역할 기반 접근 제어 | ✅ 적용 | owner/admin/staff 분리 |
| SQL Injection 방어 | ✅ 적용 | Parameterized query |
| HTTPS | ✅ 적용 | Vercel 프론트엔드 |

### 11.5 데이터 저장 형태

- DB에 저장: `ENC:base64암호화문자열...`
- API 응답: 자동 복호화되어 평문으로 전달
- 암호화 키 없이는 DB 탈취해도 복호화 불가

---

## 변경 이력

| 날짜 | 버전 | 내용 |
|------|------|------|
| 2025-12-12 | 1.3 | P-ACA 소개 추가, 공결 규정 명확화 (출석 미인정, 5주차 대체, 다음달 차감) |
| 2025-12-12 | 1.2 | 개인정보보호 규정 추가 (Phase 1 암호화 완료) |
| 2025-12-12 | 1.1 | 일할계산 4주 고정 기준으로 변경 |
| 2025-12-12 | 1.0 | 최초 작성 |
